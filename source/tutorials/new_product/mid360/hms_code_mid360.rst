通信协议中的hms_code为Mid360的诊断码，由设备主动推出，用于特殊情况的提示或者辅助用户迅速排查设备故障。

.. _诊断码组成格式:

组成格式
~~~~~~~~~~~~~~~~~~~~~~
一个完整的诊断码是一个4字节uint32代码，
其组成格式为异常ID+异常等级，见下表：

+-----------+---------+----------+
| Byte[3:2] | Byte[1] | Byte[0]  |
+===========+=========+==========+
| 异常ID    | RSVD    | 异常等级 |
+-----------+---------+----------+


其中，异常等级为非0的值，值越大严重等级越高，详见下表：

+------+----------------+--------------------------------------------------------------------------------------------+
| 值   | 等级           | 描述                                                                                       |
+======+================+============================================================================================+
| 0x01 | Info消息       | 正常工作情况下的消息通知                                                                   |
+------+----------------+--------------------------------------------------------------------------------------------+
| 0x02 | Warning警告    | 出现可能会影响设备继续正常工作的风险，请及时排查问题                                       |
+------+----------------+--------------------------------------------------------------------------------------------+
| 0x03 | Error错误      | 此时设备在非正常情况下继续工作，应及时排查问题，长期处于此状态可能会造成永久不可恢复的风险 |
+------+----------------+--------------------------------------------------------------------------------------------+
| 0x04 | fatal严重错误  | 严重异常，可能存在物理上不可恢复的风险，此时将停止工作                                     |
+------+----------------+--------------------------------------------------------------------------------------------+


解析示例
~~~~~~~~~~~~~~~~~~~~~~

如一个0x01020002的hms_code，按照 :ref:`诊断码组成格式<诊断码组成格式>`，
其异常ID为0x0102、异常等级为0x02(Warning)。

查找以下诊断码表可知，此诊断码代表“环境温度超过60度”，该异常的严重程度为warning，
建议的处理办法为“请检查环境温度，或排查散热措施”。

诊断码表
~~~~~~~~~~~~~~~~~~~~~~

==================  ================== ============================================= ===========================================                                       
异常ID                异常等级            异常描述                                         处理办法
------------------  ------------------ --------------------------------------------- -------------------------------------------                                         
0x0102              warning             设备运行环境温度偏高                            请检查环境温度，或排查散热措施
0x0104              warning             设备球形光窗存在脏污，设备点云数据可信度较差      请及时清洗擦拭设备的球形光窗
0x0111              fatal              设备内部器件温度异常                            请检查环境温度，或排查散热措施
0x0112              fatal              设备内部器件温度异常                            请检查环境温度，或排查散热措施
0x0113              fatal              设备内部IMU器件暂停工作                         请重启设备恢复
0x0114              error               设备运行环境温度高                              请检查环境温度，或排查散热措施
0x0115              fatal              设备运行环境温度超过承受极限，设备已停止工作      请检查环境温度，或排查散热措施
0x0116              fatal              设备外部电压异常                                请检查外部电压
0x0117              fatal              设备参数异常                                    请尝试重启设备恢复
0x0201              warning             扫描模块低温加热中                              请等待加热完成，加热完成后将正常工作
0x0210-0x0219       error               扫描模块异常，正在尝试自恢复中                   请等待，若长时间未恢复，请尝试重启
0x0210-0x0219       fatal              扫描模块异常                                    请尝试重启设备恢复
0x0401              warning            检测到以太网连接曾断开过                         请检查以太网链路是否存在异常
0x0402              warning            ptp同步中断，或者时间跳变太大                    请排查ptp时钟源是否工作正常
0x0403              warning            ptp版本为1588-v2.1版本，设备不支持该版本        请更换1588-v2.0版本进行同步
0x0404              warning            pps同步异常                                    请检查pps及gps信号
0x0405              warning            时间同步曾经发生过异常                          请检查发生异常原因
0x0406              warning            时间同步精度低                                  请检查同步源
0x0407              warning            缺失gps信号导致gps时间同步失败                   请检查gps信号
0x0408              warning            缺失pps信号导致gps时间同步失败                   请检查pps信号
0x0409              warning            gps信号异常                                    请检查gps信号源
0x040A              warning            ptp和gptp信号同时存在，同步存在问题              请检查网络拓扑，单独使用ptp或gptp同步
==================  ================== ============================================= ===========================================